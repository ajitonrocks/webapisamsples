name: Generate and save SSH key

on:
  workflow_dispatch:

jobs:
  generate-ssh-key:
    runs-on: ubuntu-latest

    steps:
      - name: Generate SSH Key
        run: |
          ssh-keygen -t rsa -b 4096 -C "shekhawatajit@hotmail.com" -f ssh_key -q -N ""
          echo "SSH_PRIVATE_KEY=$(cat ssh_key.pub)" >> $GITHUB_ENV
          echo "SSH_PUBLIC_KEY=$(cat ssh_key)" >> $GITHUB_ENV
        id: ssh-key
           
      - uses: gliech/create-github-secret-action@v1
        with:
          name: FRONT_DOOR_PASSWORD
          value: ${{ env.SSH_PRIVATE_KEY }}
          pa_token: ${{ secrets.PA_TOKEN }}
      
      - name: Use the public key
        run: |
         echo "Public key value:  "${{ env.SSH_PUBLIC_KEY }}"
         echo "Private key value: ${{  env.SSH_PRIVATE_KEY }}"
